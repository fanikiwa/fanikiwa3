﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿
<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Fanikiwa - Peer-to-Peer Lending</title>
<link href="/Images/Dollar.ico" rel="shortcut icon" type="image/x-icon" />
<link rel="stylesheet" href="/Content/Site.css" type="text/css" />
<script src="/Scripts/jquery-2.0.3.js" type="text/javascript"></script>
<script src="/Scripts/CustomScripts.js" type="text/javascript"></script>


</head>


<body>

	<header>
		<div class="content-wrapper">

			<div class="float-left">
				<p class="site-title" title="Fanikiwa - Peer - To - Peer Lending">
					Fanikiwa - Peer - To - Peer Lending</p>
			</div>


			<div class="float-right">
				<section id="login">
					<text> Welcome To Fanikiwa, <a id="lnkloggedinuser"
						style="cursor: pointer;" href="#" onclick="ManageProfile()"
						title="Manage Profile"></a> <a id="lnklogoff"
						style="cursor: pointer;" href="#" onclick="LogOff()"
						title="Log Off">Log off</a> </text>
				</section>
			</div>



			<div id="nav">
				<ul id="menu">

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitIndexForm" style="cursor: pointer;"
									href="/Views/Home/Index.html">Home</a>
							</div>

						</div>

					</li>


					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListLendOffersForm" style="cursor: pointer;"
									href="/Views/Offers/ListLendOffers.html">Get A loan</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListBorrowOffersForm" style="cursor: pointer;"
									href="/Views/Offers/ListBorrowOffers.html">Make An
									Investment</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListMyOffersForm"
									href="/Views/Offers/ListMyOffers.html" style="cursor: pointer;">My
									Offers</a>
							</div>

						</div>

					</li>





					<li id="subMenuMyProfile">

						<div class="floatleft">

							<div>
								<a id="btnSubmitEditProfileSubForm"
									href="/Views/Account/EditProfile.html" style="cursor: pointer;">My
									Profile</a>
							</div>

						</div>

					</li>

					<li id="subMenuMyAccounts">

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyAccountsForm"
									href="/Views/Account/MyAccounts.html" style="cursor: pointer;">My
									Accounts</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyInvestMentsForm"
									href="/Views/Loans/ListMyInvestments.html"
									style="cursor: pointer;">My InvestMents</a>
							</div>

						</div>

					</li>

					<li id="subMenuMyLoans">

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyLoansForm"
									href="/Views/Loans/ListMyLoans.html" style="cursor: pointer;">My
									Loans</a>
							</div>

						</div>

					</li>

					<li id="subMenuLendingGroups">

						<div class="floatleft">

							<div>
								<a id="btnSubmitGetMyLendingGroupsForm"
									href="/Views/LendingGroups/List.html" style="cursor: pointer;">My
									Lending Groups</a>
							</div>

						</div>

					</li>


					<li id="subMenuChangePassword">

						<div class="floatleft">

							<div>
								<a id="btnSubmitChangePasswordForm"
									href="/Views/Account/_ChangePasswordPartial.html"
									style="cursor: pointer;">Change Password</a>
							</div>

						</div>

					</li>

					<li id="subMenuDeRegister">

						<div class="floatleft">

							<div>
								<a id="btnSubmitDeRegisterForm"
									href="/Views/Account/DeRegister.html" style="cursor: pointer;">DeRegister</a>
							</div>

						</div>

					</li>





					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitHelpForm" href="/Views/Home/Help.html"
									style="cursor: pointer;">Help</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitContactUsForm"
									href="/Views/Contact/ContactUs.html" style="cursor: pointer;">Contact
									Us</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitContactsForm" href="/Views/Home/Contact.html"
									style="cursor: pointer;">Contacts</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitAboutForm" href="/Views/Home/About.html"
									style="cursor: pointer;">About</a>
							</div>

						</div>

					</li>



				</ul>
			</div>


		</div>


	</header>




	<div id="body">


		<section class="content-wrapper main-content clear-fix">

			<div id="error-display-div" class="displaynone"></div>


			<hgroup class="title">
				<h2 class="page-title">Edit Profile</h2>
			</hgroup>

			<form action="javascript:void(0);">

				<fieldset>
					<legend>Edit Profile</legend>

					<article class="col1">
						<div class="pad">

							<div>
								<label for="txtEmail">Email</label> <input id="txtEmail"
									autocomplete="autocomplete" placeholder="Email"
									autofocus="autofocus" type="text"></input>
							</div>

							<div>
								<label for="txtSurname">Surname</label> <input id="txtSurname"
									autocomplete="autocomplete" placeholder="Surname" type="text"></input>
							</div>

							<div>
								<label for="txtOtherNames">OtherNames</label> <input
									autocomplete="autocomplete" id="txtOtherNames"
									placeholder="OtherNames" type="text"></input>
							</div>

							<div>
								<label for="txtTelephone">Telephone</label> <input
									autocomplete="autocomplete" id="txtTelephone"
									placeholder="Telephone" type="tel"></input>
							</div>

							<div>
								<label for="txtNationalID">NationalID</label> <input
									autocomplete="autocomplete" id="txtNationalID"
									placeholder="NationalID" type="text"></input>
							</div>


						</div>
					</article>

					<article class="col2">
						<div class="pad">

							<div>
								<label for="dtpDateOfBirth">Date Of Birth</label> <input
									id="dtpDateOfBirth" placeholder="Date Of Birth" type="date"></input>
							</div>

							<div>
								<label for="txtRefferedBy">RefferedBy</label> <input
									id="txtRefferedBy" placeholder="RefferedBy" type="number"
									min="0"></input>
							</div>


							<div>
								<label for="txtMaxRecordsToDisplay">MaxRecordsToDisplay</label>
								<input id="txtMaxRecordsToDisplay"
									placeholder="MaxRecordsToDisplay" type="number" min="0"></input>
							</div>

							<div>
								<label for="cboGender">Gender</label> <select name="Gender"
									id="cboGender">
									<option value="M">Male</option>
									<option value="F">Female</option>
								</select>
							</div>

							<div>
								<label for="cboInformBy">InformBy</label> <select
									name="InformBy" id="cboInformBy">
									<option value="Email">Email</option>
									<option value="Sms">Sms</option>
								</select>
							</div>


						</div>
					</article>

					<div style="float: left; clear: both">
						<input type="submit" value="Update" id="btnUpdate" disabled
							style="float: left; clear: both" onclick="updateProfile()" /> <input
							type="submit" value="Clear" id="btnClear" onclick="Clear()" />
					</div>

				</fieldset>


			</form>


		</section>


	</div>





	<footer>

		<hr />


		<div class="content-wrapper clearboth">
			<div class="float-left">
				<p style="font-size: 15px">Copyright &copy; Software Providers
					Limited. All Rights Reserved.</p>
			</div>
		</div>


		<div class="content-wrapper clearboth">
			<div></div>
		</div>


	</footer>



	<script type="text/javascript">
	
	if (localStorage.getItem("loggedinuser") === null) {
		window.location.href = "/Views/Account/Login.html";
	}
	  
		function initializeControls() {

			var email = localStorage.getItem('loggedinuser');
			var request = gapi.client.memberendpoint.getMemberByEmail({
				'email' : email
			}).then(function(response) {
				console.log(response);
				populateControls(response);
				enableButton();
			}, function(reason) {
				console.log('Error: ' + reason.result.error.message);
			});
		}

		function init() {
			gapi.client.load('memberendpoint', 'v1', initializeControls, ROOT);
		}

		function enableButton() {
			$("input[type=submit]").removeAttr("disabled");
		}

		function populateControls(member) {

			document.getElementById('txtEmail').value = member.result.email;
			document.getElementById('txtSurname').value = member.result.surname;
			document.getElementById('txtOtherNames').value = member.result.otherNames;
			document.getElementById('txtTelephone').value = member.result.telephone;
			document.getElementById('txtNationalID').value = member.result.nationalID;
			document.getElementById('dtpDateOfBirth').value = member.result.dateOfBirth;
			document.getElementById('txtRefferedBy').value = member.result.refferedBy;
			document.getElementById('txtMaxRecordsToDisplay').value = member.result.maxRecordsToDisplay;
			document.getElementById('cboGender').value = member.result.gender;
			document.getElementById('cboInformBy').value = member.result.informBy;

		}
	</script>

	<script type="text/javascript">
		var errormsg = '';
		errormsg += '<ul id="errorList">';

		function updateProfile() {

			errormsg = '';
			ClearException();
			errormsg += '<ul id="errorList">';
			var error_free = true;

			// Validate the entries
			var _Email = document.getElementById('txtEmail').value;
			var _Surname = document.getElementById('txtSurname').value;
			var _OtherNames = document.getElementById('txtOtherNames').value;
			var _Telephone = document.getElementById('txtTelephone').value;
			var _NationalID = document.getElementById('txtNationalID').value;
			var _DateOfBirth = document.getElementById('dtpDateOfBirth').value;
			var _RefferedBy = document.getElementById('txtRefferedBy').value;
			var _MaxRecordsToDisplay = document
					.getElementById('txtMaxRecordsToDisplay').value;
			var _Gender = document.getElementById('cboGender').value;
			var _InformBy = document.getElementById('cboInformBy').value;

			if (_Surname.length == 0) {
				errormsg += '<li>' + " Surname cannot be null " + '</li>';
				error_free = false;
			}
			if (_OtherNames.length == 0) {
				errormsg += '<li>' + " OtherNames cannot be null " + '</li>';
				error_free = false;
			}
			if (_Telephone.length == 0) {
				errormsg += '<li>' + " Telephone cannot be null " + '</li>';
				error_free = false;
			}
			if (_NationalID.length == 0) {
				errormsg += '<li>' + " NationalID cannot be null " + '</li>';
				error_free = false;
			}

			if (!error_free) {
				errormsg += "</ul>";
				$("#error-display-div").html(errormsg);
				$("#error-display-div").removeClass('displaynone');
				$("#error-display-div").addClass('displayblock');
				$("#error-display-div").show();
				return;
			} else {
				ClearException();
			}

			// Build the Request Object
			var member = {};
			member.email = _Email;
			member.surname = _Surname;
			member.otherNames = _OtherNames;
			member.telephone = _Telephone;
			member.nationalID = _NationalID;
			member.dateOfBirth = _DateOfBirth;
			member.refferedBy = _RefferedBy;
			member.maxRecordsToDisplay = _MaxRecordsToDisplay;
			member.gender = _Gender;
			member.informBy = _InformBy;

			updateProfileNow(member);
		}

		function updateProfileNow(member) {

			var request = gapi.client.memberendpoint.updateMember(member).then(
					function(response) {
						console.log(response);
						var successmessage = "Member Id: "
								+ response.result.memberId;
						localStorage.successmessage = successmessage;
						window.location.href = "/Views/Shared/Successful.html";
					}, function(reason) {
						console.log('Error: ' + reason.result.error.message);
						errormsg += '<li>' + reason + '</li>';
						DisplayException(errormsg);
						return;
					});
		}

		function Clear() {
			$("#txtEmail").val("");
			$("#txtSurname").val("");
			$("#txtOtherNames").val("");
			$("#txtTelephone").val("");
			$("#txtNationalID").val("");
			$("#dtpDateOfBirth").val("");
			$("#txtRefferedBy").val("");
			$("#txtMaxRecordsToDisplay").val("");
			$("#cboGender").val("-1");
			$("#cboInformBy").val("-1");
		}

		function DisplayException(errormsg) {

			errormsg += "</ul>";

			$("#error-display-div").html(errormsg);
			$("#error-display-div").removeClass('displaynone');
			$("#error-display-div").addClass('displayblock');
			$("#error-display-div").show();
		}

		function ClearException() {
			$('#errorList').remove();
			$('#error-display-div').empty();
		}
	</script>


	<script src="https://apis.google.com/js/client.js?onload=init"></script>



</body>


</html>
