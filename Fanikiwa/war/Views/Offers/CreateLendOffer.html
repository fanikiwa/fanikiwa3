﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Fanikiwa - Peer-to-Peer Lending</title>
<link href="/Images/Dollar.ico" rel="shortcut icon" type="image/x-icon" />
<link rel="stylesheet" href="/Content/Site.css" type="text/css" />
<script src="/Scripts/jquery-2.0.3.js" type="text/javascript"></script>
<script async src="/Scripts/fanikiwaUI.js"></script>
<script async src="/Scripts/fanikiwa.js"></script>
<script async src="/Scripts/CustomScripts.js" type="text/javascript"></script>


</head>


<body>

	<header>
		<div class="content-wrapper">

			<div class="float-left">
				<p class="site-title" title="Fanikiwa - Peer - To - Peer Lending">
					Fanikiwa - Peer - To - Peer Lending</p>
			</div>


			<div class="float-right">
				<section id="login">
					<text> Welcome To Fanikiwa, <a id="lnkloggedinuser"
						style="cursor: pointer;" href="#" onclick="ManageProfile()"
						title="Manage Profile"></a> <a id="lnklogoff"
						style="cursor: pointer;" href="#" onclick="LogOff()"
						title="Log Off">Log off</a> </text>
				</section>
			</div>



			<div id="nav">
				<ul id="menu">

					<li id="mnuHome"><a id="btnSubmitIndexForm"
						style="cursor: pointer;" href="/Views/Home/Index.html">Home</a>
						<ul class="submenu">

							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitHelpForm" href="/Views/Home/Help.html"
											style="cursor: pointer;">Help</a>
									</div>

								</div>

							</li>

							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitContactUsForm"
											href="/Views/Contact/ContactUs.html" style="cursor: pointer;">Contact
											Us</a>
									</div>

								</div>

							</li>

<!-- 							<li> -->

<!-- 								<div class="floatleft"> -->

<!-- 									<div> -->
<!-- 										<a id="btnSubmitContactsForm" href="/Views/Home/Contact.html" -->
<!-- 											style="cursor: pointer;">Contacts</a> -->
<!-- 									</div> -->

<!-- 								</div> -->

<!-- 							</li> -->

							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitAboutForm" href="/Views/Home/About.html"
											style="cursor: pointer;">About</a>
									</div>

								</div>

							</li>


						</ul></li>



					<li id="mnuGetaloan"><a>Get a loan</a>
						<ul class="submenu">
							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitIndexForm" style="cursor: pointer;"
											href="/Views/Offers/CreateBorrowOffer.html">I want to
											borrow money</a>
									</div>

								</div>

							</li>

							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitListLendOffersForm" style="cursor: pointer;"
											href="/Views/Offers/ListLendOffers.html">My offers</a>
									</div>

								</div>

							</li>


						</ul></li>


					<li id="mnuMakeaninvestment"><a>Make an investment</a>
						<ul class="submenu">
							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitIndexForm" style="cursor: pointer;"
											href="/Views/Offers/CreateLendOffer.html">I want to lend
											money</a>
									</div>

								</div>

							</li>

							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitListBorrowOffersForm" style="cursor: pointer;"
											href="/Views/Offers/ListBorrowOffers.html">My offers</a>
									</div>

								</div>

							</li>


						</ul></li>



					<li id="mnuMyprofile"><a>My profile</a>
						<ul class="submenu">

							<li id="subMenuMyAccounts">

								<div class="floatleft">

									<div>
										<a id="btnSubmitMyAccountsForm"
											href="/Views/Account/MyAccounts.html"
											style="cursor: pointer;">My accounts</a>
									</div>

								</div>

							</li>

							<li id="subMenuMyLoans">

								<div class="floatleft">

									<div>
										<a id="btnSubmitMyLoansForm"
											href="/Views/Loans/ListMyLoans.html" style="cursor: pointer;">My
											loans</a>
									</div>

								</div>

							</li>

							<li>

								<div class="floatleft">

									<div>
										<a id="btnSubmitMyInvestMentsForm"
											href="/Views/Loans/ListMyInvestments.html"
											style="cursor: pointer;">My investments</a>
									</div>

								</div>

							</li>

							<li id="subMenuLendingGroups">

								<div class="floatleft">

									<div>
										<a id="btnSubmitGetMyLendingGroupsForm"
											href="/Views/LendingGroups/List.html"
											style="cursor: pointer;">My groups</a>
									</div>

								</div>

							</li>

							<li id="mnuprofile"><a>Profile</a>
								<ul class="submenu">

									<li id="subMenuChangePassword">

										<div class="floatleft">

											<div>
												<a id="btnSubmitChangePasswordForm"
													href="/Views/Account/_ChangePasswordPartial.html"
													style="cursor: pointer;">Change Password</a>
											</div>

										</div>

									</li>

									<li id="subMenuMyProfile">

										<div class="floatleft">

											<div>
												<a id="btnSubmitEditProfileSubForm"
													href="/Views/Account/EditProfile.html"
													style="cursor: pointer;">Change my profile</a>
											</div>

										</div>

									</li>

									<li id="subMenuDeRegister">

										<div class="floatleft">

											<div>
												<a id="btnSubmitDeRegisterForm"
													href="/Views/Account/DeRegister.html"
													style="cursor: pointer;">Deregister</a>
											</div>

										</div>

									</li>

								</ul></li>

						</ul></li>

<!-- 					<li> -->

<!-- 						<div class="floatleft"> -->

<!-- 							<div> -->
<!-- 								<a id="btnSubmitListMyOffersForm" -->
<!-- 									href="/Views/Offers/ListMyOffers.html" style="cursor: pointer;">My -->
<!-- 									Offers</a> -->
<!-- 							</div> -->

<!-- 						</div> -->

<!-- 					</li> -->


				</ul>
			</div>


		</div>


	</header>




	<div id="body">


		<section class="content-wrapper main-content clear-fix">

			<div id="error-display-div" class="displaynone"></div>


			<hgroup class="title">
				<h2 class="page-title">Create Lend Offer</h2>
			</hgroup>

			<form action="javascript:void(0);">

				<fieldset>
					<legend>Create Offer</legend>

					<article class="col1">
						<div class="pad">

							<div>
								<label for="txtDescription">Description</label> <input
									id="txtDescription" placeholder="Description"
									autofocus="autofocus" type="text"></input>
							</div>

							<div>
								<label for="txtAmount">Amount</label> <input id="txtAmount"
									placeholder="Amount" type="number" min="0"></input>
							</div>

							<div>
								<label for="txtInterest">Interest Rate(%)</label> <input
									id="txtInterest" placeholder="Interest Rate(%)" type="number" min="0"></input>
							</div>

							<div>
								<label for="txtTerm">Term in Month</label> <input id="txtTerm"
									placeholder="Term in Month" type="number" min="0"></input>
							</div>


						</div>
					</article>

					<article class="col2">
						<div class="pad">

							<div>
								<label for="cboOfferType">OfferType</label> <select
									name="OfferType" id="cboOfferType">
									<option value="L">Lend</option> 
								</select>
							</div>
							
						    <div id="divOfferees"  class="displaynone">
								<label for="txtofferees">Offer made to</label> <input
									id="txtofferees" placeholder="Offerees"
									autocomplete="autocomplete" type="text"></input>
							</div>
							 
							<div>
								<label for="chkPublicOffer">PublicOffer</label> <input
									id="chkPublicOffer" placeholder="PublicOffer" type="checkbox"></input>
							</div>

							<div>
								<label for="chkPartialPay">PartialPay</label> <input
									id="chkPartialPay" placeholder="PartialPay" type="checkbox"></input>
							</div>


						</div>
					</article>

					<div style="float: left; clear: both">
					<input type="submit" value="Create" id="btnCreate"
						style="float: left; clear: both" /> <input type="submit"
						value="Clear" id="btnClear" onclick="Clear()" />
				</div>

				</fieldset>


			</form>


		</section>


	</div>




	<footer>

		<hr />
 
		<div class="content-wrapper clearboth">
			<div class="float-left">
				<p style="font-size: 15px">Copyright &copy; 
					Software Providers Limited. All Rights Reserved.</p>
			</div>
		</div>


		<div class="content-wrapper clearboth">
			<div>
 
			</div>
		</div>


	</footer>




	<script type="text/javascript">
 
	document.getElementById('btnCreate').onclick = function() {
		saveOffer();
 	  }
	
	$('#chkPublicOffer').change(function() {
        if($(this).is(":checked")) {
        	$("#divOfferees").removeClass('displaynone');
	        $("#divOfferees").addClass('displayblock');
	        $("#divOfferees").show(); 
        }else{
        	$("#divOfferees").removeClass('displayblock');
	        $("#divOfferees").addClass('displaynone');
	        $("#divOfferees").hide(); 
        }        
    });
	
	
	 	var errormsg='';
	 	errormsg +=   '<ul id="errorList">' ;
		     
		   function init() {
		         
       	  // Parameters are APIName,APIVersion,CallBack function,API Root
	       gapi.client.load('offerendpoint', 'v1',  function() { enableButton(); }, ROOT); 
         }

       function enableButton() {        
     	  $("input[type=submit]").removeAttr("disabled"); 
       }
 
      
        function saveOffer() {
 
            errormsg='';
            ClearException(); 
            errormsg +=   '<ul id="errorList">' ;
            var error_free=true;
            
        	// Validate the entries
        	var _Description = document.getElementById('txtDescription').value;
        	var _Amount = document.getElementById('txtAmount').value;
        	var _Interest = document.getElementById('txtInterest').value;
        	var _Term = document.getElementById('txtTerm').value;
        	var _OfferType = document.getElementById('cboOfferType').value; 
        	var _PublicOffer = Boolean(document.getElementById('chkPublicOffer').value);
        	var _PartialPay = Boolean(document.getElementById('chkPartialPay').value);
        	var _offerees = document.getElementById('txtofferees').value;
        	
         if(_Description.length == 0)
       	 {        		 
            errormsg += '<li>' + " Description cannot be null "   + '</li>'; 
           	error_free = false;   
       	 }
       	 if(_Amount.length == 0)
       	 {        		 
       		errormsg += '<li>' + " Amount cannot be null "   + '</li>'; 
           	error_free = false; 
       	 }
       	 if(_Interest.length == 0)
       	 {        		 
       		errormsg += '<li>' + " Interest Rate(%) cannot be null "   + '</li>'; 
           	error_free = false; 
       	 }
       	 if(_Term.length == 0)
       	 {        		 
       		errormsg += '<li>' + " Term in Month cannot be null "   + '</li>'; 
           	error_free = false;  
       	 } 

      	 if (!error_free){
	         errormsg += "</ul>";
	    	 $("#error-display-div").html(errormsg); 
	         $("#error-display-div").removeClass('displaynone');
	         $("#error-display-div").addClass('displayblock');
	         $("#error-display-div").show();  
	         return;
         }
        else{
	        ClearException(); 
         }
      	 
    	// retrieve email from local storage
    	var email = localStorage.getItem('loggedinuser'); 
    	 
        	    
    	// Build the Request Object
    	var OfferDTO = {};
    	OfferDTO.description = _Description;
    	OfferDTO.amount = _Amount;
    	OfferDTO.interest = _Interest;
    	OfferDTO.term = _Term;
    	OfferDTO.publicOffer = _PublicOffer;
    	OfferDTO.offerType = _OfferType;
    	OfferDTO.partialPay = _PartialPay;
    	OfferDTO.status = "Open";
    	OfferDTO.email = email;  
    	OfferDTO.offerees = _offerees;        	 
        	  
		saveOfferNow(OfferDTO);  
    }
                
    function saveOfferNow(OfferDTO) {
      	
    	  var request = gapi.client.offerendpoint.saveOffer(OfferDTO)
    	  .then(function(response) {
            	console.log(response);
            	var successmessage = "Offer Id: " + response.result.id;
               localStorage.successmessage = successmessage; 
               window.location.href = "/Views/Shared/Successful.html";
            }, function(reason) {
              console.log('Error: ' + reason.result.error.message);
              errormsg += '<li>' + reason + '</li>';
              DisplayException(errormsg);  
	    	 return;
            }); 
       }
                     	
         
        function Clear(){
 	       $("#txtDescription").val("");
 	       $("#txtAmount").val("");
 	       $("#txtInterest").val("");
 	       $("#txtTerm").val("");
	       $("#cboOfferType").val("L");
	       $("#chkPublicOffer").attr('checked', false);
	       $("#chkPartialPay").attr('checked', false); 
        }
          
        function DisplayException(errormsg) {
       	 
	      	errormsg += "</ul>";
	      		 
	       	 $("#error-display-div").html(errormsg); 
	         $("#error-display-div").removeClass('displaynone');
	         $("#error-display-div").addClass('displayblock');
	         $("#error-display-div").show();  
      	  }

	   	function ClearException() {
	   		$('#errorList').remove();
	   		$('#error-display-div').empty();
	   	}
       	   	
    </script>

	<script src="https://apis.google.com/js/client.js?onload=init"></script>




</body>


</html>
