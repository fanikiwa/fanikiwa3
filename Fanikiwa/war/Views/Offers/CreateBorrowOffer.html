﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Fanikiwa - Peer-to-Peer Lending</title>
<link href="/Images/Dollar.ico" rel="shortcut icon" type="image/x-icon" />
<link rel="stylesheet" href="/Content/Site.css" type="text/css" />
<script src="/Scripts/jquery-2.0.3.js" type="text/javascript"></script>
<script src="/Scripts/CustomScripts.js" type="text/javascript"></script>


</head>


<body>

	<header>
		<div class="content-wrapper">

			<div class="float-left">
				<p class="site-title" title="Fanikiwa - Peer - To - Peer Lending">
					Fanikiwa - Peer - To - Peer Lending</p>
			</div>


			<div class="float-right">
				<section id="login">
				<text> Welcome To Fanikiwa, <a id="lnkloggedinuser"
					style="cursor: pointer;" href="#" onclick="ManageProfile()"
					title="Manage Profile"></a> <a id="lnklogoff"
					style="cursor: pointer;" href="#" onclick="LogOff()"
					title="Log Off">Log off</a> </text>
				</section>
			 </div>



			<div id="nav">
				<ul id="menu">

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitIndexForm" style="cursor: pointer;"
									href="/Views/Home/Index.html">Home</a>
							</div>

						</div>

					</li>


					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListLendOffersForm" style="cursor: pointer;"
									href="/Views/Offers/ListLendOffers.html">Get A loan</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListBorrowOffersForm" style="cursor: pointer;"
									href="/Views/Offers/ListBorrowOffers.html">Make An
									Investment</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListMyOffersForm"
									href="/Views/Offers/ListMyOffers.html" style="cursor: pointer;">My
									Offers</a>
							</div>

						</div>

					</li>





					<li id="subMenuMyProfile">

						<div class="floatleft">

							<div>
								<a id="btnSubmitEditProfileSubForm"
									href="/Views/Account/EditProfile.html" style="cursor: pointer;">My
									Profile</a>
							</div>

						</div>

					</li>

					<li id="subMenuMyAccounts">

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyAccountsForm"
									href="/Views/Account/MyAccounts.html" style="cursor: pointer;">My
									Accounts</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyInvestMentsForm"
									href="/Views/Offers/ListMyInvestments.html"
									style="cursor: pointer;">My InvestMents</a>
							</div>

						</div>

					</li>

					<li id="subMenuMyLoans">

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyLoansForm"
									href="/Views/Loans/ListMyLoans.html" style="cursor: pointer;">My
									Loans</a>
							</div>

						</div>

					</li>

					<li id="subMenuOfferGroups">

						<div class="floatleft">

							<div>
								<a id="btnSubmitGetMyMailingGroupsForm"
									href="/Views/MailingGroups/MailingGroups.html"
									style="cursor: pointer;">My Offer Groups</a>
							</div>

						</div>

					</li>

					<li id="subMenuScores">

						<div class="floatleft">

							<div>
								<a id="btnSubmitOfferScoresForm"
									href="/Views/Account/ManageProfile.html"
									style="cursor: pointer;">My Offer Scores</a>
							</div>

						</div>

					</li>

					<li id="subMenuChangePassword">

						<div class="floatleft">

							<div>
								<a id="btnSubmitChangePasswordForm"
									href="/Views/Account/_ChangePasswordPartial.html"
									style="cursor: pointer;">Change Password</a>
							</div>

						</div>

					</li>

					<li id="subMenuDeRegister">

						<div class="floatleft">

							<div>
								<a id="btnSubmitDeRegisterForm"
									href="/Views/Account/DeRegister.html" style="cursor: pointer;">DeRegister</a>
							</div>

						</div>

					</li>





					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitHelpForm" href="/Views/Home/Help.html"
									style="cursor: pointer;">Help</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitContactUsForm"
									href="/Views/Contact/ContactUs.html" style="cursor: pointer;">Contact
									Us</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitContactsForm" href="/Views/Home/Contact.html"
									style="cursor: pointer;">Contacts</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitAboutForm" href="/Views/Home/About.html"
									style="cursor: pointer;">About</a>
							</div>

						</div>

					</li>



				</ul>
			</div>


		</div>


	</header>




	<div id="body">


		<section class="content-wrapper main-content clear-fix">

			<div id="error-display-div" class="displaynone"></div>


			<hgroup class="title">
				<h2 class="page-title">Create Borrow Offer</h2>
			</hgroup>

			<form action="javascript:void(0);">

				<fieldset>
					<legend>Create Offer</legend>

					<article class="col1">
						<div class="pad">

							<div>
								<label for="txtDescription">Description</label> <input
									id="txtDescription" placeholder="Description"
									autofocus="autofocus" type="text"></input>
							</div>

							<div>
								<label for="txtAmount">Amount</label> <input id="txtAmount"
									placeholder="Amount" type="number" min="0"></input>
							</div>

							<div>
								<label for="txtInterest">Interest</label> <input
									id="txtInterest" placeholder="Interest" type="number" min="0"></input>
							</div>

							<div>
								<label for="txtTerm">Term</label> <input id="txtTerm"
									placeholder="Term" type="number" min="0"></input>
							</div>


						</div>
					</article>

					<article class="col2">
						<div class="pad">

							<div>
								<label for="cboOfferType">OfferType</label> <select
									name="OfferType" id="cboOfferType"> 
									<option value="B">Borrow</option>
								</select>
							</div>
							
					    <div>
							<label for="txtofferees">Offerees</label> <input
								id="txtofferees" placeholder="Offerees"
								autocomplete="autocomplete" type="text"></input>
						</div>
						
							<div>
								<label for="chkPublicOffer">PublicOffer</label> <input
									id="chkPublicOffer" placeholder="PublicOffer" type="checkbox"></input>
							</div>

							<div>
								<label for="chkPartialPay">PartialPay</label> <input
									id="chkPartialPay" placeholder="PartialPay" type="checkbox"></input>
							</div>


						</div>
					</article>

					<div style="float: left; clear: both">
					<input type="submit" value="Create" id="btnCreate"
						style="float: left; clear: both" /> <input type="submit"
						value="Clear" id="btnClear" onclick="Clear()" />
				</div>

				</fieldset>


			</form>


		</section>


	</div>




	<footer>

		<hr />
 
		<div class="content-wrapper clearboth">
			<div class="float-left">
				<p style="font-size: 15px">Copyright &copy;  
					Software Providers Limited. All Rights Reserved.</p>
			</div>
		</div>


		<div class="content-wrapper clearboth">
			<div>
 
			</div>
		</div>


	</footer>




	<script type="text/javascript">

    if (localStorage.getItem("loggedinuser") === null) {
     window.location.href = "/Views/Account/Login.html";
	 }

		 // Get loggedin user from the local storage
		 $('#lnkloggedinuser').text(localStorage.getItem('loggedinuser'));

		 	var errormsg='';
		 	errormsg +=   '<ul id="errorList">' ;
		       // var ROOT ='https://1-dot-fanikiwaweb.appspot.com/_ah/api';
		       var ROOT ='http://localhost:8888/_ah/api';   
		       function init() {
		        
		        	try {
		        	  
       	  // Parameters are APIName,APIVersion,CallBack function,API Root
	       gapi.client.load('offerendpoint', 'v1', null, ROOT);
	       gapi.client.load('memberendpoint', 'v1', null, ROOT);
          
          // wire the submit button
	       document.getElementById('btnCreate').onclick = function() {
		   MakeOffer();
        	  }
	       
        	} catch(exception) {  
                console.log("Error : " + exception);
                errormsg += '<li>' + exception   + '</li>';
                DisplayException(errormsg); 
         }
   }
        
     // function that will execute the getMemberByEmail call
     function  getMemberByEmail(email)
     {     
       	try {
     // make the api call
     gapi.client.memberendpoint.getMemberByEmail(email).execute(function(resp) {
       		if (!resp.code) {       			 
       		return resp;       		
       		}       		  
       		else {
       			console.log(resp.code + " : " + resp.message); 
    			errormsg += '<li>' + resp.code + " : " + resp.message   + '</li>';
    			DisplayException(errormsg);
       		}
       	});       	
       	} catch(exception) { 
       		console.log("Error : " + exception);
            errormsg += '<li>' + exception   + '</li>';
            DisplayException(errormsg); 
      }
     }
        // function that will execute the MakeOffer call
        function MakeOffer() {

           	try {
           	
            errormsg='';
            ClearException(); 
            errormsg +=   '<ul id="errorList">' ;
            var error_free=true;
            
        	// retrieve the entries
        	var _Description = document.getElementById('txtDescription').value;
        	var _Amount = document.getElementById('txtAmount').value;
        	var _Interest = document.getElementById('txtInterest').value;
        	var _Term = document.getElementById('txtTerm').value;
        	var _OfferType = document.getElementById('cboOfferType').value; 
        	var _PublicOffer = Boolean(document.getElementById('chkPublicOffer').value);
        	var _PartialPay = Boolean(document.getElementById('chkPartialPay').value);
        	var _offerees = document.getElementById('txtofferees').value;
        	
         if(_Description.length == 0)
       	 {        		 
            errormsg += '<li>' + " Description cannot be null "   + '</li>'; 
           	error_free = false;   
       	 }
       	 if(_Amount.length == 0)
       	 {        		 
       		errormsg += '<li>' + " Amount cannot be null "   + '</li>'; 
           	error_free = false; 
       	 }
       	 if(_Interest.length == 0)
       	 {        		 
       		errormsg += '<li>' + " Interest cannot be null "   + '</li>'; 
           	error_free = false; 
       	 }
       	 if(_Term.length == 0)
       	 {        		 
       		errormsg += '<li>' + " Term cannot be null "   + '</li>'; 
           	error_free = false;  
       	 } 

      	 if (!error_free){
	         errormsg += "</ul>";
	    	 $("#error-display-div").html(errormsg); 
	         $("#error-display-div").removeClass('displaynone');
	         $("#error-display-div").addClass('displayblock');
	         $("#error-display-div").show();  
	         return;
         }
        else{
	        ClearException(); 
         }
      	 
        	// retrieve email from local storage
        	var email = localStorage.getItem('loggedinuser')  
        	 
        	    
        	// Build the Request Object
        	var OfferDTO = {};
        	OfferDTO.description = _Description;
        	OfferDTO.amount = _Amount;
        	OfferDTO.interest = _Interest;
        	OfferDTO.term = _Term;
        	OfferDTO.publicOffer = _PublicOffer;
        	OfferDTO.offerType = _OfferType;
        	OfferDTO.partialPay = _PartialPay;
        	OfferDTO.status = "Open";
        	OfferDTO.email = email;  
        	OfferDTO.offerees = _offerees;  	 
        	 
        	gapi.client.offerendpoint.saveOffer(OfferDTO).execute(function(resp) {
        		if (!resp.code) {
        			 
        		window.location.href = "/Views/Shared/Successful.html";
        		
        		} 
        		else {
        			console.log(resp.code + " : " + resp.message); 
        			errormsg += '<li>' + resp.code + " : " + resp.message   + '</li>';
        			DisplayException(errormsg);
        		}    
        	});        	
        	} catch(exception) { 
        		console.log("Error : " + exception);
                errormsg += '<li>' + exception   + '</li>';
                DisplayException(errormsg); 
        }
     }        	
        
        function Clear(){
 	       $("#txtDescription").val("");
 	       $("#txtAmount").val("");
 	       $("#txtInterest").val("");
 	       $("#txtTerm").val("");
 	       $("#cboOfferType").val("L");
	       $("#chkPublicOffer").attr('checked', false);
	       $("#chkPartialPay").attr('checked', false); 
        }
        
         	function LogOff() { 
         	localStorage.removeItem("loggedinuser");
            window.location.href = "/Views/Account/Login.html";  
         	}
         	
         	function ManageProfile() { 
         	window.location.href = "/Views/Account/EditProfile.html";  
            }
         
	        function DisplayException(errormsg) {
	       	 
		      	errormsg += "</ul>";
		      		 
		       	 $("#error-display-div").html(errormsg); 
		         $("#error-display-div").removeClass('displaynone');
		         $("#error-display-div").addClass('displayblock');
		         $("#error-display-div").show();  
	      	  }

	   	   	function ClearException() {
	   	   		$('#errorList').remove();
	   	   		$('#error-display-div').empty();
	   	   	}
       	   	
    </script>

	<script src="https://apis.google.com/js/client.js?onload=init"></script>




</body>


</html>
